# 模型相关目录说明

本文档解释项目中与模型相关的各个目录的用途和它们之间的关系。

## 目录结构概览

项目中有三个主要的与模型相关的目录：

1. 项目根目录下的 `ml_models/`
2. 后端应用目录下的 `backend/app/models/`
3. 后端应用目录下的 `backend/app/services/`

## 各目录职责

### 1. ml_models/ (机器学习模型)

**位置**: 项目根目录
**用途**: 研发、训练和存储机器学习模型

此目录包含：
- `trained/`: 存放所有训练好的模型文件
  - `trained/voice_models/`: 语音相关模型（如音频特征模型、声音健康评估模型等）
  - `trained/large_models/`: 大型模型（如语音分析大模型、定制化大语言模型等）
- `training/`: 存放模型训练相关脚本和代码

**大型模型存放位置：** 所有训练好的大型模型（包括自定义训练的大语言模型、语音分析大模型等）都应放在`ml_models/trained/large_models/`目录中。这样便于管理和版本控制大型模型文件。

这个目录主要关注机器学习模型的研发、训练和保存，是数据科学家和机器学习工程师的工作区域。

### 2. backend/app/models/ (后端模型实现)

**位置**: 后端应用目录
**用途**: 实现模型相关的底层功能类

此目录包含：
- `feature_extractor.py`: 音频特征提取器的具体实现
- 其他模型相关的实现类

这个目录主要关注底层功能的实现，如特征提取算法。这些类通常被服务层调用，不直接暴露给API层。

### 3. backend/app/services/ (服务层)

**位置**: 后端应用目录
**用途**: 提供业务服务，包括使用机器学习模型

此目录包含：
- `model_service.py`: 负责加载和使用机器学习模型的服务类

服务层是连接底层模型和API层的桥梁。它负责加载`ml_models/trained/`中的模型，并使用`backend/app/models/`中的功能类来提供完整的业务服务。

## 工作流程

1. 数据科学家在`ml_models/training/`中开发和训练模型
2. 训练好的模型保存在`ml_models/trained/`目录（根据模型类型和大小放入相应子目录）
3. 后端开发者在`backend/app/models/`中实现特征提取和其他模型相关功能
4. 服务层`backend/app/services/`加载训练好的模型，并使用模型实现提供服务
5. API端点调用服务层的方法完成请求处理

## 最佳实践

1. 保持`ml_models/`目录专注于机器学习研发
2. 保持`backend/app/models/`专注于具体功能实现
3. 使用`backend/app/services/`作为桥梁连接模型和API
4. 在`backend/app/api/`层只调用服务层的方法，不直接使用模型
5. 避免在多个地方重复实现相同的逻辑

## 大型模型存储建议

对于体积较大的模型文件（如定制化大语言模型），建议：

1. 使用Git LFS (Large File Storage)进行版本控制
2. 考虑将非常大的模型存储在外部存储服务（如AWS S3、阿里云OSS等）
3. 在代码中通过配置文件指定模型的远程URL，需要时再下载
4. 为大型模型提供检查点（checkpoints）和版本标记
5. 在模型目录中保留说明文档（README.md），描述模型的用途、训练数据、性能指标和使用方法 